<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lightning Protection Risk Assessment</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Lightning Protection Risk Assessment Tool</h1>
    <p>Based on BS EN 62305-2:2012 | StrikeRisk v6.0-style</p>
  </header>

  <main>
    <!-- 1. Project & Case -->
    <section id="project-details">
      <h2>Project & Case Information</h2>
      <form id="projectForm" class="form-grid">
        <label>Project Name:<input type="text" name="projectName" required /></label>
        <label>Client:<input type="text" name="client" /></label>
        <label>Project Address:<input type="text" name="projectAddress" /></label>
        <label>Prepared By:<input type="text" name="preparedBy" /></label>
        <label>Date:<input type="date" name="date" /></label>
        <label>Case Name:<input type="text" name="caseName" /></label>
      </form>
    </section>

    <!-- 2. Environmental -->
    <section id="environmental-factors">
      <h2>Environmental Factors</h2>
      <form id="envForm" class="form-grid">
        <label>Ground Flash Density (Ng):
          <select name="Ng">
            <option value="">Select Ng</option>
            <option value="0.2">5 thunderstorm days/y (0.2)</option>
            <option value="0.5">10 days/y (0.5)</option>
            <option value="1.1">20 days/y (1.1)</option>
            <option value="1.9">30 days/y (1.9)</option>
            <option value="2.8">40 days/y (2.8)</option>
            <option value="3.7">50 days/y (3.7)</option>
            <option value="4.7">60 days/y (4.7)</option>
            <option value="6.9">80 days/y (6.9)</option>
            <option value="9.2">100 days/y (9.2)</option>
          </select>
        </label>
        <label>Location Factor (CD):
          <select name="CD">
            <option value="">Select CD</option>
            <option value="1.0">Isolated or hilltop (1.0)</option>
            <option value="0.5">Similar surroundings (0.5)</option>
            <option value="0.25">Surrounded by taller (0.25)</option>
          </select>
        </label>
        <label>Environmental Factor (CE):
          <select name="CE">
            <option value="">Select CE</option>
            <option value="1.0">Rural (1.0)</option>
            <option value="0.5">Suburban (0.5)</option>
            <option value="0.1">Urban (0.1)</option>
            <option value="0.01">Urban > 20 m (0.01)</option>
          </select>
        </label>
        <label>External LPZ:
          <select name="extLPZ">
            <option value="">Select LPZ</option>
            <option value="0">LPZ 0</option>
            <option value="0a">LPZ 0a</option>
            <option value="0b">LPZ 0b</option>
          </select>
        </label>
        <label>Internal LPZ:
          <select name="intLPZ">
            <option value="">Select LPZ</option>
            <option value="1">LPZ 1</option>
            <option value="2">LPZ 2</option>
          </select>
        </label>
      </form>
    </section>

    <!-- 3. Main Structure -->
    <section id="structure-inputs">
      <h2>Primary Structure</h2>
      <form id="structForm" class="form-grid">
        <label>Height H (m):<input type="number" step="0.01" name="H" required /></label>
        <label>Length L (m):<input type="number" step="0.01" name="L" required /></label>
        <label>Width W (m):<input type="number" step="0.01" name="W" required /></label>
        <label>Structure Factor (KS1):
          <select name="KS1">
            <option value="">Select KS1</option>
            <option value="1.0">Non-conductive (1.0)</option>
            <option value="0.6">Non-cond w/ LPS I (0.6)</option>
            <option value="0.6">Cond frame, non-cond cladding (0.6)</option>
            <option value="0.25">Cond frame, cond cladding (0.25)</option>
            <option value="0.01">Cond frame, metal cladding 100 mm (0.01)</option>
            <option value="0.001">Cond frame, metal cladding 10 mm (0.001)</option>
            <option value="0.0001">Fully metal, no openings (0.0001)</option>
          </select>
        </label>
        <label>Internal Shielding (KS2):
          <select name="KS2">
            <option value="">Select KS2</option>
            <option value="1.0">No shielding (1.0)</option>
            <option value="0.6">Partial (0.6)</option>
            <option value="0.3">Full (0.3)</option>
          </select>
        </label>
        <label>Wiring Factor (KS3):
          <select name="KS3">
            <option value="">Select KS3</option>
            <option value="1.0">Normal wiring (1.0)</option>
            <option value="0.5">Grounded conduit (0.5)</option>
            <option value="0.1">Optical fibre (0.1)</option>
          </select>
        </label>
        <label>Protection Level (LPL):
          <select name="LPL">
            <option value="none">No LPS (PB = 1.0)</option>
            <option value="IV">IV (PB = 0.2)</option>
            <option value="III">III (PB = 0.1)</option>
            <option value="II">II (PB = 0.05)</option>
            <option value="I">I (PB = 0.02)</option>
          </select>
        </label>
      </form>
    </section>

    <!-- 4. Remote Structures -->
    <section id="remote-structures">
      <h2>Remote Structures</h2>
      <div id="remoteList"></div>
      <button type="button" onclick="addRemote()">+ Add Remote Structure</button>
      <template id="remoteTemplate">
        <div class="remote-entry">
          <h3>Remote Structure <span class="remote-num"></span></h3>
          <label>Height H (m):<input type="number" step="0.01" class="remote-H" /></label>
          <label>Length L (m):<input type="number" step="0.01" class="remote-L" /></label>
          <label>Width W (m):<input type="number" step="0.01" class="remote-W" /></label>
          <label>Location Factor (CDJ):
            <select class="remote-CDJ">
              <option value="">Select CDJ</option>
              <option value="1.0">Isolated or hilltop (1.0)</option>
              <option value="0.5">Similar surroundings (0.5)</option>
              <option value="0.25">Surrounded by taller (0.25)</option>
            </select>
          </label>
          <button type="button" onclick="removeRemote(this)">Remove</button>
        </div>
      </template>
    </section>

    <!-- 5. Service Lines -->
    <section id="line-manager">
      <h2>Connected Service Lines</h2>
      <div id="lineList"></div>
      <button type="button" onclick="addLine()">+ Add Service Line</button>
      <template id="lineTemplate">
        <div class="line-entry">
          <h3>Line <span class="line-num"></span></h3>
          <label>Type:
            <select class="line-type">
              <option value="power">Power</option>
              <option value="telecom">Telecom/Data</option>
              <option value="other">Other</option>
            </select>
          </label>
          <label>Route Type (CI):
            <select class="line-ci">
              <option value="1.0">Overhead (1.0)</option>
              <option value="0.5">Buried (0.5)</option>
              <option value="0.25">Conduit (0.25)</option>
            </select>
          </label>
          <label>Length (m):
            <select class="line-length">
              <option value="100">100</option>
              <option value="200">200</option>
              <option value="500">500</option>
              <option value="1000">1000</option>
            </select>
          </label>
          <label>Shielding (CLD/CLI):
            <select class="line-shield">
              <option value="1.0">Unshielded (1.0)</option>
              <option value="0.5">Partial (0.5)</option>
              <option value="0.25">Full (0.25)</option>
            </select>
          </label>
          <button type="button" onclick="removeLine(this)">Remove Line</button>
        </div>
      </template>
    </section>

    <!-- 6. Zones -->
    <section id="zone-manager">
      <h2>Zones (LPZs)</h2>
      <div id="zoneList"></div>
      <button type="button" onclick="addZone()">+ Add Zone</button>
      <template id="zoneTemplate">
        <div class="zone-entry">
          <h3>Zone <span class="zone-num"></span></h3>
          <label>Zone Type:
            <select class="zone-lpz">
              <option value="1">LPZ 1 Internal</option>
              <option value="2">LPZ 2 Internal</option>
              <option value="0a">LPZ 0a External</option>
              <option value="0b">LPZ 0b External</option>
            </select>
          </label>
          <label>Occupancy (n_z):
            <select class="zone-nz">
              <option value="0.01">1–10 people (0.01)</option>
              <option value="0.05">10–50 people (0.05)</option>
              <option value="0.1">50–100 people (0.1)</option>
              <option value="0.2">100+ people (0.2)</option>
            </select>
          </label>
          <label>Exposure (t_z):
            <select class="zone-tz">
              <option value="365">1 hr/day (365)</option>
              <option value="2920">8 hr/day (2920)</option>
              <option value="8760">24/7 (8760)</option>
            </select>
          </label>
          <label>Special Hazard (h_z):
            <select class="zone-hz">
              <option value="1.0">None (1.0)</option>
              <option value="2.0">Flammable (2.0)</option>
              <option value="3.0">Explosive (3.0)</option>
            </select>
          </label>
          <label>Fire Protection (r_p):
            <select class="zone-rp">
              <option value="1.0">None (1.0)</option>
              <option value="0.8">Alarm only (0.8)</option>
              <option value="0.5">Extinguishing (0.5)</option>
            </select>
          </label>
          <label>Floor Type (r_t):
            <select class="zone-rt">
              <option value="1.0">Conductive (1.0)</option>
              <option value="0.8">Semi (0.8)</option>
              <option value="0.5">Non-cond (0.5)</option>
            </select>
          </label>
          <button type="button" onclick="removeZone(this)">Remove Zone</button>
        </div>
      </template>
    </section>

    <!-- 7. Protection Measures -->
    <section id="protection-measures">
      <h2>Protection Measures</h2>
      <form id="protectionForm" class="form-grid">
        <label>LPS Installed:
          <select name="lpsInstalled">
            <option value="">Select</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
          </select>
        </label>
        <label>Lightning Protection Level (LPL):
          <select name="LPL">
            <option value="none">No LPS (PB = 1.0)</option>
            <option value="IV">IV (PB = 0.2)</option>
            <option value="III">III (PB = 0.1)</option>
            <option value="II">II (PB = 0.05)</option>
            <option value="I">I (PB = 0.02)</option>
          </select>
        </label>
        <label>Service Entrance SPD I_SPD (kA):
          <select name="ISPD">
            <option value="0">None</option>
            <option value="2.5">2.5</option>
            <option value="12.5">12.5</option>
            <option value="25.0">25.0</option>
          </select>
        </label>
        <label>Equipot. SPD (P_EB):
          <select name="PEB"><option value="0.05">Default (0.05)</option></select>
        </label>
        <label>Coord. SPD (P_SPD):
          <select name="PSPD"><option value="0.05">Default (0.05)</option></select>
        </label>
        <label>Impulse Withstand (U_W, kV):
          <select name="UW">
            <option value="1">1</option>
            <option value="1.5">1.5</option>
            <option value="2.5">2.5</option>
            <option value="4">4</option>
            <option value="6">6</option>
          </select>
        </label>
      </form>
    </section>

    <!-- 8. Actions & Results -->
    <section id="actions">
      <button type="button" onclick="calculateRisk()">Calculate Risk</button>
      <button type="button" onclick="exportPDF()">Export to PDF</button>
    </section>
    <section id="results">
      <h2>Results</h2>
      <div id="resultDisplay">Select inputs and click Calculate.</div>
    </section>
  </main>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
<script src="script.js"></script>
</body>
</html>
